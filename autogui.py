# This file is part of AutoGUI.
# Copyright 2025 Peer Lukat
# Peer.Lukat@helmholtz-hzi.de
# Helmholtz-Centre for Infection Research, Structure & Function of Proteins
#
#    AutoGUI is free software: you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation, either version 3 of the License, or
#    any later version.
#
#    AutoGUI is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with AutoGUI.  If not, see <http://www.gnu.org/licenses/>.


version = 'v.20250307'                             # current version
# LINUX!

# Dependencies required:
# FreeSimpleGUI (pip install FreeSimpleGUI)
# psutil (pip install psutil)
# PIL (pip install Pillow)
# Working installation of GPhL AutoPROC (www.globalphasing.com/autoproc/)
# Working installation of CCP4i (www.ccp4.ac.uk)
# Working installation of Adxv for Image viewing (www.scripps.edu/tainer/arvai/adxv.html)
# Working installation of ImageMagick (www.imagemagick.org)
# Something to open PDFs
# Some webbrowser
# Screen for batch processing


# Fallback configuration if config file can't be read
browser = "chromium"                                  # path to/ command to start browser  
dark_theme = False                                    # use dark or light theme  
inpath = "/Data/"                                     # change this to default in path
outpath = "~"                                          # change this to default out path
preplist = 'refine coot phaser xtriage autobuild pdb_deposit ccp4 pymol' # list of folders to create if "prepare folders" is checked. "autoproc" is required and will always be created. "images" will be created if linking image files is enabled. "beamline_processed" will be created if linking of beamline-processed data is enabled and such data is found.
prepfolder_classic = True
prepfolder_batch = True
use_screen = True

theme_highlight_color = '#458eaf'
dark_theme_color = '#2b2a32' 
light_theme_color = 'white'

color_option_1 = '#458eaf'
color_option_2 = '#8fb0a9'
color_option_3 = '#639867'
color_option_4 = '#b64040'
color_option_5 = '#c46316'
color_option_6 = '#d8a2c8'

theme_color_rgb = [69, 142, 175]




# import PySimpleGUI as sg
import FreeSimpleGUI as sg
import subprocess
import os
import re
import sys
import pwd
import threading
import time
import datetime
import gc


# icon
ag_icon = b'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WHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNC40LjAtRXhpdjIiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6aXB0Y0V4dD0iaHR0cDovL2lwdGMub3JnL3N0ZC9JcHRjNHhtcEV4dC8yMDA4LTAyLTI5LyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgIHhtbG5zOnBsdXM9Imh0dHA6Ly9ucy51c2VwbHVzLm9yZy9sZGYveG1wLzEuMC8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICB4bXBNTTpEb2N1bWVudElEPSJnaW1wOmRvY2lkOmdpbXA6YWE1YmZkYTUtZGEzMy00OWI4LWI5ODktOGNjMWRhNWNhYjYxIgogICB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjdjMzZhMWRhLTZmMzEtNDU0My05ZGIxLWIzNzVmYWFmYTA2MyIKICAgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjQ1ODg3YWUxLTA0MTEtNDVkNy1iNDFlLWM4YjJjM2Q1ZjgwMCIKICAgR0lNUDpBUEk9IjIuMCIKICAgR0lNUDpQbGF0Zm9ybT0iTWFjIE9TIgogICBHSU1QOlRpbWVTdGFtcD0iMTY2MzMzOTE3MDAzNjYzNyIKICAgR0lNUDpWZXJzaW9uPSIyLjEwLjYiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBleGlmOkNvbG9yU3BhY2U9IjEiCiAgIGV4aWY6UGl4ZWxYRGltZW5zaW9uPSIyOTk5IgogICBleGlmOlBpeGVsWURpbWVuc2lvbj0iMTY4NyIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIKICAgdGlmZjpYUmVzb2x1dGlvbj0iMjI1IgogICB0aWZmOllSZXNvbHV0aW9uPSIyMjUiCiAgIHhtcDpDcmVhdG9yVG9vbD0iR0lNUCAyLjEwIj4KICAgPGlwdGNFeHQ6TG9jYXRpb25DcmVhdGVkPgogICAgPHJkZjpCYWcvPgogICA8L2lwdGNFeHQ6TG9jYXRpb25DcmVhdGVkPgogICA8aXB0Y0V4dDpMb2NhdGlvblNob3duPgogICAgPHJkZjpCYWcvPgogICA8L2lwdGNFeHQ6TG9jYXRpb25TaG93bj4KICAgPGlwdGNFeHQ6QXJ0d29ya09yT2JqZWN0PgogICAgPHJkZjpCYWcvPgogICA8L2lwdGNFeHQ6QXJ0d29ya09yT2JqZWN0PgogICA8aXB0Y0V4dDpSZWdpc3RyeUlkPgogICAgPHJkZjpCYWcvPgogICA8L2lwdGNFeHQ6UmVnaXN0cnlJZD4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZmFmOTA0YWYtMmYyMC00MTg0LWI3ZjAtYWIxNzQxZGE2MzczIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKE1hYyBPUykiCiAgICAgIHN0RXZ0OndoZW49IjIwMjItMDktMTZUMTY6Mzk6MzArMDI6MDAiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogICA8cGx1czpJbWFnZVN1cHBsaWVyPgogICAgPHJkZjpTZXEvPgogICA8L3BsdXM6SW1hZ2VTdXBwbGllcj4KICAgPHBsdXM6SW1hZ2VDcmVhdG9yPgogICAgPHJkZjpTZXEvPgogICA8L3BsdXM6SW1hZ2VDcmVhdG9yPgogICA8cGx1czpDb3B5cmlnaHRPd25lcj4KICAgIDxyZGY6U2VxLz4KICAgPC9wbHVzOkNvcHlyaWdodE93bmVyPgogICA8cGx1czpMaWNlbnNvcj4KICAgIDxyZGY6U2VxLz4KICAgPC9wbHVzOkxpY2Vuc29yPgogIDwvcmRmOkRlc2NyaXB0aW9uPgogPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+IMG9ZQAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAimgAAIpoBvt37KgAAAAd0SU1FB+YJEA4nHeKdlGcAABbwSURBVHja7VtpdBTXlf6qq6q7el/U3ZK6taMdIbAQSAYBYrFZbBzbOMbByYkdEmeZzJyxjyeZiWcmM8cOjteZOJl4EgeCAcdOvOAYYxZjB2ywWY0BgQRoQRJaW2r1vlR1Vc0P/MrVWC1hx0vmHNc5fdSIVtW737v3u9+99zXw5fXl9eX1RVzXXXfddAAz1a+SkpKrNm7caP4810F91g84c+YM88gjjyx64YUXGu12eyPDMLUjtNlryS8FRVHgLHZQGg0SwTFIkojYyAC0w51BmqZPOhyOo5FI5O3ly5e/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'
ag_64 = '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WHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNC40LjAtRXhpdjIiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6aXB0Y0V4dD0iaHR0cDovL2lwdGMub3JnL3N0ZC9JcHRjNHhtcEV4dC8yMDA4LTAyLTI5LyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgIHhtbG5zOnBsdXM9Imh0dHA6Ly9ucy51c2VwbHVzLm9yZy9sZGYveG1wLzEuMC8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICB4bXBNTTpEb2N1bWVudElEPSJnaW1wOmRvY2lkOmdpbXA6YWE1YmZkYTUtZGEzMy00OWI4LWI5ODktOGNjMWRhNWNhYjYxIgogICB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjdjMzZhMWRhLTZmMzEtNDU0My05ZGIxLWIzNzVmYWFmYTA2MyIKICAgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjQ1ODg3YWUxLTA0MTEtNDVkNy1iNDFlLWM4YjJjM2Q1ZjgwMCIKICAgR0lNUDpBUEk9IjIuMCIKICAgR0lNUDpQbGF0Zm9ybT0iTWFjIE9TIgogICBHSU1QOlRpbWVTdGFtcD0iMTY2MzMzOTE3MDAzNjYzNyIKICAgR0lNUDpWZXJzaW9uPSIyLjEwLjYiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBleGlmOkNvbG9yU3BhY2U9IjEiCiAgIGV4aWY6UGl4ZWxYRGltZW5zaW9uPSIyOTk5IgogICBleGlmOlBpeGVsWURpbWVuc2lvbj0iMTY4NyIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIKICAgdGlmZjpYUmVzb2x1dGlvbj0iMjI1IgogICB0aWZmOllSZXNvbHV0aW9uPSIyMjUiCiAgIHhtcDpDcmVhdG9yVG9vbD0iR0lNUCAyLjEwIj4KICAgPGlwdGNFeHQ6TG9jYXRpb25DcmVhdGVkPgogICAgPHJkZjpCYWcvPgogICA8L2lwdGNFeHQ6TG9jYXRpb25DcmVhdGVkPgogICA8aXB0Y0V4dDpMb2NhdGlvblNob3duPgogICAgPHJkZjpCYWcvPgogICA8L2lwdGNFeHQ6TG9jYXRpb25TaG93bj4KICAgPGlwdGNFeHQ6QXJ0d29ya09yT2JqZWN0PgogICAgPHJkZjpCYWcvPgogICA8L2lwdGNFeHQ6QXJ0d29ya09yT2JqZWN0PgogICA8aXB0Y0V4dDpSZWdpc3RyeUlkPgogICAgPHJkZjpCYWcvPgogICA8L2lwdGNFeHQ6UmVnaXN0cnlJZD4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZmFmOTA0YWYtMmYyMC00MTg0LWI3ZjAtYWIxNzQxZGE2MzczIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKE1hYyBPUykiCiAgICAgIHN0RXZ0OndoZW49IjIwMjItMDktMTZUMTY6Mzk6MzArMDI6MDAiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogICA8cGx1czpJbWFnZVN1cHBsaWVyPgogICAgPHJkZjpTZXEvPgogICA8L3BsdXM6SW1hZ2VTdXBwbGllcj4KICAgPHBsdXM6SW1hZ2VDcmVhdG9yPgogICAgPHJkZjpTZXEvPgogICA8L3BsdXM6SW1hZ2VDcmVhdG9yPgogICA8cGx1czpDb3B5cmlnaHRPd25lcj4KICAgIDxyZGY6U2VxLz4KICAgPC9wbHVzOkNvcHlyaWdodE93bmVyPgogICA8cGx1czpMaWNlbnNvcj4KICAgIDxyZGY6U2VxLz4KICAgPC9wbHVzOkxpY2Vuc29yPgogIDwvcmRmOkRlc2NyaXB0aW9uPgogPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+IMG9ZQAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAimgAAIpoBvt37KgAAAAd0SU1FB+YJEA4nHeKdlGcAABbwSURBVHja7VtpdBTXlf6qq6q7el/U3ZK6taMdIbAQSAYBYrFZbBzbOMbByYkdEmeZzJyxjyeZiWcmM8cOjteZOJl4EgeCAcdOvOAYYxZjB2ywWY0BgQRoQRJaW2r1vlR1Vc0P/MrVWC1hx0vmHNc5fdSIVtW737v3u9+99zXw5fXl9eX1RVzXXXfddAAz1a+SkpKrNm7caP4810F91g84c+YM88gjjyx64YUXGu12eyPDMLUjtNlryS8FRVHgLHZQGg0SwTFIkojYyAC0w51BmqZPOhyOo5FI5O3ly5e/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'

print('')
print("**************************************************************************************************")
print("     AutoGUI - a python-based GUI for running GPhL autoPROC")
print("     Copyright 2025 Peer Lukat")
print("     peer.lukat@helmholtz-hzi.de")
print("     AutoGUI is free software released under the GNU General Public License Version 3 (or later)") 
print("     (GPL-3.0-or-later)")
print("**************************************************************************************************")
print('')

config_path = os.path.join(os.path.dirname(__file__), 'autogui.cfg')                        # path to configuration file
classic_path = os.path.join(os.path.dirname(__file__), 'autogui_classic.py')                # path to autogui_classic
batch_path = os.path.join(os.path.dirname(__file__), 'autogui_batch.py')                    # path to autogui_batch
changelog_path = os.path.join(os.path.dirname(__file__), 'autogui_changelog.txt')           # path to changelog
license_path = os.path.join(os.path.dirname(__file__), 'COPYING')                           # path to GNU GENERAL PUBLIC LICENSE Version 3
personal_config = os.path.join(os.path.expanduser('~'), ".autogui_priv.cfg")                # path to personal config
#print(personal_config)

welcome = "Welcome to AutoGUI " + version + "\na python-based GUI for running GPhL autoPROC"
win_title = 'AutoGUI-Launcher ' + version

connect_command = None
task = None
debug = False
found_results = []
#find_path = os.path.expanduser('~')
find_path = outpath
find_number = '20'
classicresults = True
batchresults = True
default_table_values = [['         ','         ','                                                ']]
table_values = default_table_values
include_commandline = True
exclude_failed = False
logtitle = "AutoGUI Logfiles"

# Helper function to find last results
def get_results(classicresults, batchresults,find_path,find_number):
    found_results = []
    user = pwd.getpwuid(os.getuid()).pw_name
    if classicresults == True and batchresults == False:
        searchvar = "-name autogui_log.html"
    elif classicresults == False and batchresults == True:
        searchvar = "-name batchproc.html"
    else:
        searchvar = '-type f \( -name "autogui_log.html" -o -name "batchproc.html" \)' 
    findcheck1 = re.compile("autogui_log.html")
    findcheck2 = re.compile("batchproc.html")
    if sys.platform == 'darwin':
        find_command = "find " + find_path + " " + searchvar + " -user " + user + " -exec stat -f '%m %N' {} \; | sort -nr | awk 'NR==1,NR==" + find_number +" {print $2}'" # darwin
    else:
        find_command = "find " + find_path + " " + searchvar + " -user " + user + " -exec stat -c '%Y %n' {} \; | sort -nr | awk 'NR==1,NR==" + find_number +" {print $2}'" # Linux
    while True:
        find_results = subprocess.Popen(find_command, stdout=subprocess.PIPE, universal_newlines=True, shell=True)
        output = (find_results.stdout.readlines())
        for line in output:
            line = line.strip()
            if findcheck1.search(line) != None or findcheck2.search(line) != None:
                moddate = int(os.path.getmtime(line))
                #print(moddate)
                logdate = datetime.datetime.fromtimestamp(moddate).strftime('%x')
                #print (line)
                if findcheck1.search(line) != None:
                    logtype = "Classic"
                else: 
                    logtype = "Batch"

                short_path = "./" + os.path.relpath(line, find_path) 
                found_result = [logdate, logtype, short_path]
                found_results.append(found_result)
        #print(found_results)       
        return found_results
        break  

# Helper function to get screen info
def screen_info():
    user = pwd.getpwuid(os.getuid()).pw_name
    os.system('screen -wipe')
    screenargs = []
    while True:
        check_screen_command = 'screen -ls'
        screencheck = re.compile(user)
        screendiscard = re.compile('Socket')
        check_screen = subprocess.Popen(check_screen_command, stdout=subprocess.PIPE, universal_newlines=True, shell=True)
        output = (check_screen.stdout.readlines())
        for line in output:
            line = line.strip()
            #print(line)
            if (screencheck.search(line) != None) and (screendiscard.search(line) == None):
                screenarg = (re.split("[\. \(\)]+", line))
                screenarg.pop()
                screenargs.append(screenarg)
                #for screenarg in screenargs:
                    #print(screenarg)      
        return screenargs
        break  

# export results
def export_results(exporttype, exportpath, filetoexport, find_path, table_values, theme_color, theme_color1, theme_color2, include_commandline, exclude_failed, logtitle):
    exportlist = [] #0=Date, 1=Mode, 2=Table path, 3=Absolute path, 4= Relative path, 5=CSV read
    if theme_color1 == 'white':
        alt_theme_color1 = '#fafafa'
    else:    
        alt_theme_color1 = 'black'

    for table_value in table_values:
        absolute_table_path = os.path.join(find_path,table_value[2].strip("./"))
        relative_table_path = os.path.relpath(absolute_table_path, exportpath)
        table_value.append(absolute_table_path)
        table_value.append(relative_table_path)
        print(absolute_table_path)
        path_with_stuff = re.split("/[^/]+$", absolute_table_path)[0]
        csv_read = []
        csv_item = ['N/A', 'N/A', 'N/A', 'N/A', 'N/A', 'N/A', 'N/A', 'N/A'] # Dataset ID;Successful processing;Space group;Cell dimensions [];Cell angles [];Isotropic diffraction limit [];Anisotropic diffraction limits [];Autoproc command line
        if table_value[1] == 'Classic':
            path_to_csv = os.path.join(path_with_stuff, "useful_files/datasets.csv")
        else:
            path_to_csv = os.path.join(path_with_stuff, "datasets.csv")   
        if os.path.exists(path_to_csv):
            #print(path_to_csv, "found.")
            with open (path_to_csv, 'rt') as csvfile:
                for line in csvfile:
                    #print(line, "line in csv")
                    line = line.strip()
                    csv_read.append(line)
            csvfile.close()  
            csv_read.pop(0)
        else:
            #print(path_to_csv, "does not exist.")
            csv_read = []
        table_value.append(csv_read)
        exportlist.append(table_value)            

    #print(exportlist)
    f = open(filetoexport, "w")
    if exporttype == ".csv":
        f.write('#;Date;Processing mode;Path;Dataset ID;Successful processing;Space group;Cell dimensions [];Cell angles [];Isotropic diffraction limit [];Anisotropic diffraction limits [];Autoproc command line\n')
        exp_counter = 1
        for exportvalue in exportlist:
            csv_read = exportvalue[5]
            if len(csv_read) > 0:
                content_counter = 1
                for line in csv_read:
                    #print(line)
                    csv_item = (line.strip()).split(';')
                    csv_item.pop(0)
                    csv_values = ';'.join(csv_item)
                    if len(csv_read) > 1:
                        ds_count = str(exp_counter) + "." + str(content_counter)
                    else:
                        ds_count = str(exp_counter)    
                    table_line = ds_count + ";" + exportvalue[0] + ";" + exportvalue[1] + ";" + exportvalue[3] + ";" + csv_values
                    table_line = table_line + "\n"
                    f.write(table_line)
                    print(table_line)
                    content_counter = content_counter + 1
            else:
                csv_item = ['N/A', 'N/A', 'N/A', 'N/A', 'N/A', 'N/A', 'N/A', 'N/A']
                csv_values = ';'.join(csv_item)
                table_line = str(exp_counter) + ";" + exportvalue[0] + ";" + exportvalue[1] + ";" + exportvalue[3] + ";" + csv_values
                table_line = table_line + "\n"
                f.write(table_line)      
            exp_counter = exp_counter + 1
    else:
        f.write('<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"\n')
        f.write('"http://www.w3.org/TR/html4/loose.dtd">\n')
        f.write('<html>\n')
        f.write('<head>\n')
        title = '    <title>Exported list of AutoGUI processing results</title>\n'
        f.write(title)
        f.write('<style>\n')
        f.write('    a:link {\n')
        f.write(' font-family: arial, sans-serif;\n')
        f.write(' border-collapse: collapse;\n')
        f.write(' font-size:13px;\n')
        f.write(' color: '+ theme_color2 +' ;\n')
        f.write(' text-decoration: none;\n')
        f.write('}\n')
        f.write('    a:visited {\n')
        f.write(' font-family: arial, sans-serif;\n')
        f.write(' border-collapse: collapse;\n')
        f.write(' font-size:13px;\n')
        f.write(' color: '+ theme_color2 +' ;\n')
        f.write(' text-decoration: none;\n')
        f.write('}\n')    
        f.write('a:hover {\n')
        f.write(' color: ' + theme_color + ';\n')
        f.write(' text-decoration: underline;\n')
        f.write('}\n')
        f.write('a:active {\n')
        f.write(' color: '+ alt_theme_color1 +' ;\n')
        f.write(' text-decoration: underline;\n')
        f.write('}\n')			
        f.write('table {\n')
        f.write(' font-family: arial, sans-serif;\n')
        f.write(' border-collapse: collapse;\n')
        f.write(' width: 95%;\n')
        f.write('}\n')
        f.write('button {\n')
        f.write('	font-size:13px;\n') 
        f.write('	color: '+ theme_color1 +' ;\n') 
        f.write('	background-color: ' + theme_color + ';\n') 
        f.write('	border: none;\n')
        f.write('	outline: none;\n')     
        f.write('	padding: 4px 4px;\n') 
        f.write('	cursor: pointer;\n') 
        f.write('	border-color: ' + theme_color + ';\n')
        f.write('	display: block;\n')
        f.write('	width: 100%;\n')
        f.write('	text-align: center;\n')
        f.write('	position: relative;\n')
        f.write('}\n')
        f.write('button:hover {\n')
        f.write('	color: ' + theme_color + ';\n') 
        f.write('	background-color: '+ theme_color1+ ' ;\n');
        f.write('	border: 1px solid ' + theme_color + ';\n');
        f.write('	padding: 3px 3px;\n');
        f.write('}\n')
        f.write('table {\n')
        f.write(' font-family: arial, sans-serif;\n')
        f.write(' border-collapse: collapse;\n')
        f.write(' width: 95%;\n')
        f.write('}\n')
        f.write('\n')
        f.write('td, th {\n')
        f.write(' border: 0px solid '+ theme_color1 +' ;\n')
        f.write(' text-align: left;\n')
        f.write(' padding: 8px;\n')
        f.write(' font-size:13px;\n')
        f.write('}\n')
        f.write('\n')
        f.write('td {\n')
        f.write(' background-color: '+ theme_color1 +' ;\n')
        f.write('}\n')
        f.write('\n')
        f.write('th {\n')
        f.write('background-color: ' + theme_color + ';\n')
        f.write('   color: '+ theme_color1 +' ; \n')
        f.write('}\n')
        f.write('</style>\n')
        f.write('</head>\n')
        f.write('<body style="background-color:'+ alt_theme_color1 +';>\n')
        f.write('<center>\n')
        f.write('<div class="main">\n')
        f.write('<center>\n')
        f.write('	<table>\n')
        f.write("            <tr>\n")
        f.write("            <th style='font-size:6px; text-align: center; color: white; background-color: "+ theme_color + "; width: 40px'><img src=\"data:image/png;base64,"+ ag_64 +" alt=\"AutoGUI Logo\" /><a> AutoGUI "+ version + "</a></td>\n")  
        f.write("		        <th> </th>\n") 
        f.write("		        <th style='color: white; font-size:20px'; colspan=\"3\">" + logtitle + "</th>\n")
        if exclude_failed == False:
            f.write("		        <th> </th>\n")  
        if include_commandline == True:
            f.write("		        <th> </th>\n") 
        f.write("               <th style='font-size:13px; text-align: left; color: white; background-color: "+ theme_color + "'>Searched in:<br>" + find_path + "</th>\n")    
        f.write("               <th style='font-size:13px; text-align: left; color: white; background-color: "+ theme_color + "; width: 140px'>Search date:<br>"+ datetime.date.today().strftime("%m/%d/%y") + "</th>\n")    
        f.write("	       </tr>\n")
        f.write("         <tr>\n")
        f.write("	<tr style = 'background-color: " + alt_theme_color1 + "'><td style = 'background-color: " + alt_theme_color1 + "'></td> </tr>\n")
        f.write("	<tr style = 'background-color: " + alt_theme_color1 + "'><td style = 'background-color: " + alt_theme_color1 + "'></td> </tr>\n")
        numberofexports = 0 
        for exportvalue in exportlist:
            failed_counter = 0
            success_counter = 0
            failed_job = False
            csv_read = exportvalue[5]
            if len(csv_read) > 0:
                for line in csv_read:
                    line = (line.strip()).split(';')
                    if line[2] == "True":
                        success_counter = success_counter + 1
                    if line[2] == "False":
                        failed_counter = failed_counter + 1    
            if (success_counter == 0) and (failed_counter > success_counter):
                failed_job = True
            else:
                failed_job = False 
            if (failed_job == False) or (exclude_failed == False):
                numberofexports = numberofexports + 1     
                f.write("         <tr  style='background-color: "+ alt_theme_color1 +"'>\n")   
                if exporttype == "absolute links":
                    f.write("		        <td style='font-size:13px; background-color: "+ theme_color1 +"'; colspan=\"2\"> <b><a href = " + exportvalue[3] + " target =\"_blank\">Date: " + exportvalue[0] + "</a></b></td>\n")
                    f.write("		        <td style='font-size:13px; background-color: "+ theme_color1 +"'; colspan=\"1\"> <b><a href = " + exportvalue[3] + " target =\"_blank\">Mode: " + exportvalue[1] + "</a></b></td>\n")
                    f.write("		        <td style='font-size:13px; color: " + theme_color + "; background-color: "+ theme_color1 +"'; colspan=\"3\"> <b><u><a href = " + exportvalue[3] + " target =\"_blank\">Processing log: " + exportvalue[3] + "</a></u></b></td>\n")
                    if exclude_failed == False:
                        f.write("		        <td style='font-size:13px; color: " + theme_color + "; background-color: "+ theme_color1 +"'> <b><u><a href = " + exportvalue[3] + " target =\"_blank\"> </a></u></b></td>\n")  
                    if include_commandline == True:
                        f.write("		        <td style='font-size:13px; color: " + theme_color + "; background-color: "+ theme_color1 +"'> <b><u><a href = " + exportvalue[3] + " target =\"_blank\"> </a></u></b></td>\n") 
                    f.write("		        <td style='font-size:13px; background-color: "+ theme_color1 +"'; colspan=\"1\"> <b><a href = " + exportvalue[3] + " target =\"_blank\">Jobs: </a><a style='color: "+ theme_color2 + "'>" + str(success_counter+failed_counter) + "<sup style='font-size:8px; color: #d0d0d0'>total</sup></a><a style='color: green'>" + str(success_counter) + "<sup style='font-size:8px; color: #d0d0d0'>done</sup></a><a style='color: red'>" + str(failed_counter) + "<sup style='font-size:8px; color: #d0d0d0'>failed</sup></a></b></td>\n")
                else:
                    f.write("		        <td style='font-size:13px; background-color: "+ theme_color1 +"'; colspan=\"2\"> <b><a href = " + exportvalue[4] + " target =\"_blank\">Date: " + exportvalue[0] + "</a></b></td>\n")
                    f.write("		        <td style='font-size:13px; background-color: "+ theme_color1 +"'; colspan=\"1\"> <b><a href = " + exportvalue[4] + " target =\"_blank\">Mode: " + exportvalue[1] + "</a></b></td>\n")
                    f.write("		        <td style='font-size:13px; color: " + theme_color + "; background-color: "+ theme_color1 +"'; colspan=\"3\"> <b><u><a href = " + exportvalue[4] + " target =\"_blank\">Processing log: " + exportvalue[3] + "</a></u></b></td>\n")
                    if exclude_failed == False:
                        f.write("		        <td style='font-size:13px; color: " + theme_color + "; background-color: "+ theme_color1 +"'> <b><u><a href = " + exportvalue[4] + " target =\"_blank\"> </a></u></b></td>\n")  
                    if include_commandline == True:
                        f.write("		        <td style='font-size:13px; color: " + theme_color + "; background-color: "+ theme_color1 +"'> <b><u><a href = " + exportvalue[4] + " target =\"_blank\"> </a></u></b></td>\n") 
                    f.write("		        <td style='font-size:13px; background-color: "+ theme_color1 +"'; colspan=\"1\"> <b><a href = " + exportvalue[4] + " target =\"_blank\">Jobs: </a><a style='color: "+ theme_color2 + "'>" + str(success_counter+failed_counter) + "<sup style='font-size:8px; color: #d0d0d0'>total</sup></a><a style='color: green'>" + str(success_counter) + "<sup style='font-size:8px; color: #d0d0d0'>done</sup></a><a style='color: red'>" + str(failed_counter) + "<sup style='font-size:8px; color: #d0d0d0'>failed</sup></a></b></td>\n")
                f.write("         </tr>\n")
                f.write("         <tr style='background-color: "+ theme_color +"'>\n")
                f.write("		        <td style='font-size:13px; color: white; background-color: "+ theme_color +"'> <b>#</b></td>\n")
                if exclude_failed == False:
                    f.write("		        <td style='font-size:13px; color: white; background-color: "+ theme_color +"'> <b>Status</b></td>\n")
                f.write("		        <td style='font-size:13px; color: white; background-color: "+ theme_color +"'> <b>Dataset</b></td>\n")
                f.write("		        <td style='font-size:13px; color: white; background-color: "+ theme_color +"'> <b>Space group</b></td>\n")
                f.write("		        <td style='font-size:13px; color: white; background-color: "+ theme_color +"'> <b>Cell dimensions []</b></td>\n")
                f.write("		        <td style='font-size:13px; color: white; background-color: "+ theme_color +"'> <b>Cell angles []</b></td>\n")
                f.write("		        <td style='font-size:13px; color: white; background-color: "+ theme_color +"'> <b>Isotropic diffraction limit []</b></td>\n")
                f.write("		        <td style='font-size:13px; color: white; background-color: "+ theme_color +"'> <b>Anisotropic diffraction limits []</b></td>\n")
                if include_commandline == True:
                    f.write("		        <td style='font-size:13px; color: white; background-color: "+ theme_color +"'> <b>Autoproc command line</b></td>\n")
                f.write("         </tr>\n")
                csv_read = exportvalue[5]
                if len(csv_read) > 0:
                    content_counter = 1
                    for line in csv_read:
                        csv_item = (line.strip()).split(';')
                        csv_item.pop(0)
                        if (exclude_failed == False) or (csv_item[1] == "True"):
                            f.write("         <tr style='background-color: "+ theme_color1 +"'>\n")
                            if len(csv_read) > 1:
                                ds_count = str(numberofexports) + "." + str(content_counter)
                            else:
                                ds_count = str(numberofexports) 
                            #csv_item =  Dataset ID;Successful processing;Space group;Cell dimensions [];Cell angles [];Isotropic diffraction limit [];Anisotropic diffraction limits [];Autoproc command line    
                            f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + ds_count + "</a></td>\n") 
                            try:
                                if exclude_failed == False:
                                    if csv_item[1] == "True":
                                        f.write("		        <td style='font-size:25px; color: green; background-color: "+ theme_color1 +"'><a><b>&#10004;</b></a></td>\n")
                                    else:
                                        f.write("		        <td style='font-size:25px; color: red; background-color: "+ theme_color1 +"'><a><b>&#10008;</b></a></td>\n")     
                                f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[0] + "</a></td>\n") 
                                f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[2] + "</a></td>\n")
                                f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[3] + "</a></td>\n")
                                f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[4] + "</a></td>\n")
                                f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[5] + "</a></td>\n") 
                                f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[6] + "</a></td>\n")   
                                if include_commandline == True:
                                    f.write("		        <td style='font-size:10px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[7] + "</a></td>\n")        
                            except:
                                f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>N/A</a></td>\n") 
                                print('Missing csv data!')
                                print('')
                            f.write("	        </tr>\n") 
                            content_counter = content_counter + 1
                else:
                    f.write("         <tr style='background-color: "+ theme_color1 +"'>\n")
                    csv_item = ['N/A', 'N/A', 'N/A', 'N/A', 'N/A', 'N/A', 'N/A', 'N/A']
                    f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + str(numberofexports) + "</a></td>\n")
                    if exclude_failed == False:
                        f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[1] + "</a></td>\n") 
                    f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[0] + "</a></td>\n") 
                    f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[2] + "</a></td>\n")
                    f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[3] + "</a></td>\n")
                    f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[4] + "</a></td>\n")
                    f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[5] + "</a></td>\n") 
                    f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[6] + "</a></td>\n")   
                    if include_commandline == True:
                        f.write("		        <td style='font-size:13px; color: " + theme_color2 + "; background-color: "+ theme_color1 +"'> <a>" + csv_item[7] + "</a></td>\n") 
                    f.write("	        </tr>\n")             
                f.write("	<tr style = 'background-color: " + alt_theme_color1 + "'><td style = 'background-color: " + alt_theme_color1 + "'></td></tr>\n")
                
        f.write('	</table>\n')
        f.write('\n')
        f.write('</div>\n')
        f.write('</center>\n')
        f.write('</body>\n')
        f.write('</html>\n')
    f.close()
    print("Wrote", filetoexport)        

# thread for generic long function to keep gui working
def browser_thread(window):
    browser_command = (browser + ' ' + browser_target)
    subprocess.Popen(browser_command, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL, universal_newlines=True, shell=True)
        
#helper function to open browser in thread
def open_browser(browser, browser_target):
    threading.Thread(target=browser_thread, args=(window,), daemon=True).start()

def save_preferences(dark_theme, theme_highlight_color, prepfolder_classic, prepfolder_batch, preplist, inpath, outpath, use_screen):
    f = open(personal_config, "w")
    f.write('# Use dark theme?\n')
    prefline = 'dark_theme = ' + str(dark_theme) + '\n\n'
    f.write(prefline)
    f.write('# Theme highlight color (hex value)\n')
    prefline = 'theme_highlight_color = ' + str(theme_highlight_color) + '\n\n'
    f.write(prefline)
    f.write('# Make subfolders in CLASSIC mode?\n')
    prefline = 'prepfolder_classic = ' + str(prepfolder_classic) + '\n\n'
    f.write(prefline)
    f.write('# Make subfolders in BATCH mode?\n')
    prefline = 'prepfolder_batch = ' + str(prepfolder_batch) + '\n\n'
    f.write(prefline)    
    f.write('# Which subfolders to make?\n')
    prefline = 'preplist = ' + str(preplist) + '\n\n'
    f.write(prefline) 
    f.write('# Default input root path?\n')
    prefline = 'inpath = ' + str(inpath) + '\n\n'
    f.write(prefline)  
    f.write('# Default output root path?\n')
    prefline = 'outpath = ' + str(outpath) + '\n\n'
    f.write(prefline)
    f.write('# Use "screen" for detached execution of autoGUI batch?\n')
    prefline = 'use_screen = ' + str(use_screen) + '\n\n'
    f.write(prefline)         
    f.close()
    print("Wrote", personal_config)  

# color space conversion for themes
def hex_to_rgb(hexval):
    hexval = hexval.strip('#')
    return tuple(int(hexval[i:i+2], 16) for i in (0, 2, 4))
def rgb_to_hex(rgbcol):
    hexcolor = '#' + ('{:02X}' * 3).format(rgbcol[0], rgbcol[1], rgbcol[2])
    return hexcolor

#MAIN CODE STARTS HERE


# very first thing check if autoPROC works
proccheck_command = ("process -h")
proccheck_line_count = 0
proccheck_results = subprocess.Popen(proccheck_command, stdout=subprocess.PIPE, universal_newlines=True, shell=True)
proccheck = (proccheck_results.stdout.readlines())
for line in proccheck:
    proccheck_line_count = proccheck_line_count + 1
if proccheck_line_count < 10:
    print('')
    print("-----WARNING!-----")
    print("There seems to be an issue with your instance of autoPROC.")
    print("A common issue for this message is that your autoPROC license has expired.")
    print("Check the status of your autoPROC version by typing 'process -h' on the terminal.")
    print('')
    sys.exit("Exiting.")    


# first thing: check if you have write access in the current folder
current_path = os.getcwd()
if os.access(current_path, os.W_OK) == False:
    print('')
    print("-----WARNING!-----")
    print("AutoGUI has to be started from a folder where you have permissions to write data!")
    print('')
    sys.exit("Exiting.")

# second thing: check if global config-file is available and read values
if os.path.exists(config_path) == True:
    cfg_browser = re.compile("browser = ")
    cfg_inpath = re.compile("inpath = ")
    cfg_outpath = re.compile("outpath = ")
    cfg_preplist = re.compile("preplist = ") 
    cfg_prepclassic = re.compile("prepfolder_classic = ")
    cfg_prepbatch = re.compile("prepfolder_batch = ")
    cfg_dark = re.compile("dark_theme = ")  
    with open (config_path, 'rt') as config:
        for line in config:
            line = line.strip() 
            if cfg_browser.search(line) != None:
                browser = (re.split(cfg_browser, line))[-1]
            if cfg_dark.search(line) != None:
                dark_theme = (re.split(cfg_dark, line))[-1]
                if dark_theme == ("True" or "true" or "TRUE" or "y" or "Y" or "yes" or "Yes" or "YES"):
                    dark_theme = True
                else:
                    dark_theme = False
            if cfg_prepclassic.search(line) != None:
                prepfolder_classic = (re.split(cfg_prepclassic, line))[-1]
                if prepfolder_classic == ("True" or "true" or "TRUE" or "y" or "Y" or "yes" or "Yes" or "YES"):
                    prepfolder_classic = True
                else:
                    prepfolder_classic = False
            if cfg_prepbatch.search(line) != None:
                prepfolder_batch = (re.split(cfg_prepbatch, line))[-1]
                if prepfolder_batch == ("True" or "true" or "TRUE" or "y" or "Y" or "yes" or "Yes" or "YES"):
                    prepfolder_batch = True
                else:
                    prepfolder_batch = False
            if cfg_inpath.search(line) != None:
                inpath = (re.split(cfg_inpath, line))[-1]
            if cfg_outpath.search(line) != None:
                outpath = (re.split(cfg_outpath, line))[-1]
            if cfg_preplist.search(line) != None:
                preplist = (re.split(cfg_preplist, line))[-1]                                            
    config.close()
else:
    print('')
    print('Global configuration file not found.')
    print('Falling back to default parameters.')
    print('')  

# third thing: check if personal config-file is available and read values
if os.path.exists(personal_config) == True:
    print("Personal config file found.")
    cfg_inpath = re.compile("inpath = ")
    cfg_outpath = re.compile("outpath = ")
    cfg_preplist = re.compile("preplist = ") 
    cfg_prepclassic = re.compile("prepfolder_classic = ")
    cfg_prepbatch = re.compile("prepfolder_batch = ")
    cfg_dark = re.compile("dark_theme = ")  
    cfg_highlight = re.compile("theme_highlight_color = ")
    cfg_screen = re.compile("use_screen = ")
    with open (personal_config, 'rt') as config:
        for line in config:
            line = line.strip() 
            if cfg_dark.search(line) != None:
                dark_theme = (re.split(cfg_dark, line))[-1]
                if dark_theme == ("True" or "true" or "TRUE" or "y" or "Y" or "yes" or "Yes" or "YES"):
                    dark_theme = True
                else:
                    dark_theme = False
            if cfg_prepclassic.search(line) != None:
                prepfolder_classic = (re.split(cfg_prepclassic, line))[-1]
                if prepfolder_classic == ("True" or "true" or "TRUE" or "y" or "Y" or "yes" or "Yes" or "YES"):
                    prepfolder_classic = True
                else:
                    prepfolder_classic = False
            if cfg_prepbatch.search(line) != None:
                prepfolder_batch = (re.split(cfg_prepbatch, line))[-1]
                if prepfolder_batch == ("True" or "true" or "TRUE" or "y" or "Y" or "yes" or "Yes" or "YES"):
                    prepfolder_batch = True
                else:
                    prepfolder_batch = False
            if cfg_inpath.search(line) != None:
                inpath = (re.split(cfg_inpath, line))[-1]
            if cfg_outpath.search(line) != None:
                outpath = (re.split(cfg_outpath, line))[-1]
            if cfg_preplist.search(line) != None:
                preplist = (re.split(cfg_preplist, line))[-1]  
            if cfg_highlight.search(line) != None:
                theme_highlight_color = (re.split(cfg_highlight, line))[-1]
            if cfg_screen.search(line) != None:
                use_screen = (re.split(cfg_screen, line))[-1]
                if use_screen == ("True" or "true" or "TRUE" or "y" or "Y" or "yes" or "Yes" or "YES"):
                    use_screen = True
                else:
                    use_screen = False
    config.close()
else:
    print('')
    print('Personal configuration file not found.')
    print('Falling back to default parameters for now.')
    print('')
    print('--Go to "Preferences" in the menu to customize your AutoGUI experience!--')
    print('') 
    
outpath = os.path.expanduser(outpath)
find_path = outpath

if os.path.exists(classic_path) == True:
    classic_disabled = False
    classic_color = 'black'
    classic_text = 'Run AutoGUI in "CLASSIC" mode for single dataset processing with many options.'
else:
    classic_disabled = True
    classic_color = '#A0A0A0'
    classic_text = 'AutoGUI-Classic seems not to be installed on your system.'

if os.path.exists(batch_path) == True:
    batch_disabled = False
    batch_color = 'black'
    batch_text = 'Run AutoGUI in "BATCH" mode for fast processing of many datasets.'
else:
    batch_disabled = True
    batch_color = '#A0A0A0'
    batch_text = 'AutoGUI-Batch seems not to be installed on your system.'

menu_def = ['Unused', ['&Preferences', '&Load and export results', '&Connect to running batch job', '&Kill previous batch job', '&Quit',]]

## GUI THEME DEFINITIONS


if dark_theme == True:
    # Definition of dark GUI theme
    theme_color = theme_highlight_color                    # theme highlight color
    theme_color1 =  dark_theme_color                       # theme background color
    theme_color2 = 'white'                                 # theme text color
    theme_color3 = '#2b2a32'                               # theme button and input text color
else:
    # Definition of light GUI theme
    theme_color = theme_highlight_color                   # theme highlight color
    theme_color1 = light_theme_color                      # theme background color
    theme_color2 = 'black'                                # theme text color
    theme_color3 = 'white'                                # theme button and input text color

Color_Theme = {'BACKGROUND': theme_color1,
               'TEXT': theme_color2,
               'INPUT': theme_color,
               'TEXT_INPUT': theme_color3,
               'SCROLL': theme_color,
               'BUTTON': (theme_color3, theme_color),
               'PROGRESS': (theme_color, '#D0D0D0'),
               'BORDER': 0,
               'SLIDER_DEPTH': 0,
               'PROGRESS_DEPTH': 0}

theme_color_rgb = hex_to_rgb(theme_color)

# Add your dictionary to the PySimpleGUI themes
sg.theme_add_new('AutoTheme', Color_Theme)

# Set PySimpleGui Theme and define options
sg.theme('AutoTheme')
sg.set_options(font = 'Helvetica 10', titlebar_background_color = theme_color1, titlebar_text_color = theme_color2, titlebar_icon = ag_icon, icon = ag_icon)


layout = [[sg.Frame(layout= 
                   [[sg.Button('', key ='-LOGOBUTTON-', image_data=ag_icon, image_subsample = 1, border_width = 0, button_color=(sg.theme_background_color(),sg.theme_background_color()), enable_events = True, tooltip = 'About'),
                         sg.Text(version, key ='-ABOUT-', font = "Helvetica 8", justification = "right", size = (11, 1),text_color = theme_color, enable_events = True, tooltip = 'About')],
                         [sg.Button('  Classic', key ='-CLASSIC-', font = ("Helvetica 11"), disabled = classic_disabled, highlight_colors = (theme_color, theme_color), tooltip = classic_text, size = (16,2), pad = ((1, 1), (1, 1)))],
                          [sg.Button('  Batch', key ='-BATCH-', font = ("Helvetica 11"), disabled = batch_disabled, highlight_colors = (theme_color, theme_color), tooltip = batch_text, size = (16,2), pad = ((1, 1), (1, 1)))],
                          [sg.Col([[(sg.ButtonMenu('\u2630', menu_def, key = '-MENU-',size = (1,1), font = ("Helvetica 14"), button_color = (theme_color, theme_color1), tooltip = 'Menu', border_width = 0, pad = ((1, 1), (1, 1))))]], justification = "center")]
                          ],
                          title = None, relief=sg.RELIEF_GROOVE, border_width = 0, pad = (1,1,1,1))]]

# create window
window = sg.Window(win_title, layout, no_titlebar=False, grab_anywhere=False, resizable=False, finalize=True, location = (300, 100))

print('\u2691  Ready.')

#do stuff
while True:
    event, values = window.read()
    #print(event)        

# show about section
    if event == '-ABOUT-' or event == '-LOGOBUTTON-':
        layout_about = [[sg.Text(win_title, justification = "left", font = "Arial 12", text_color = theme_color)],
                               [sg.Text('A simple interface to autoPROC (Global Phasing Ltd.)')],
                               [sg.HorizontalSeparator(color = None,)],
                               [sg.Text('\u00A9 Copyright 2025 Peer Lukat\nHelmholtz-Centre for Infection Research, Structure & Function of Proteins\npeer.lukat@helmholtz-hzi.de\nAutoGUI is released under the GNU General Public License Version 3 (or later).\nThere is (currently) no literature citation for it.')],
                               [sg.HorizontalSeparator(color = None,)],
                               [sg.Text('autoPROC is developed by Global Phasing Limited (UK)\nhttps://www.globalphasing.com')],
                               [sg.Text('For using autoPROC via AutoGUI, please cite:')],
                               [sg.Text('autoPROC:\nVonrhein, C., Flensburg, C., Keller, P., Sharff, A., Smart, O., Paciorek, W.,\nWomack, T. and Bricogne, G. (2011). Data processing and analysis with\nthe autoPROC toolbox. Acta Cryst. D67, 293-302.')],
                               [sg.Text('XDS/XSCALE:\nKabsch, W. (2010). XDS. Acta Cryst. D66, 125-132.')],
                               [sg.Text('POINTLESS:\nEvans, P.R. (2006). Scaling and assessment of data quality, Acta Cryst. D62, 72-82.')],
                               [sg.Text('CCP4:\nWinn, M.D., Ballard, C.C., Cowtan, K.D. Dodson, E.J., Emsley, P., Evans, P.R.,\nKeegan, R.M., Krissinel, E.B., Leslie, A.G.W., McCoy, A., McNicholas, S.J., Murshudov,\nG.N., Pannu, N.S., Potterton, E.A., Powell, H.R., Read, R.J., Vagin, A. and Wilson, K.S.\n(2011). Overview of the CCP4 suite and current developments, Acta. Cryst. D67, 235-242.')], 
                               [sg.Text('STARANISO:\nTickle, I.J., Flensburg, C., Keller, P., Paciorek, W., Sharff, A., Vonrhein, C.,\nand Bricogne, G. (2018-2021). STARANISO. Cambridge, United Kingdom: Global Phasing Ltd.')],
                               [sg.Text('AutoGUI is also using Adxv:\nArvai, A. Adxv - A Program to Display X-ray Diffraction Images,\nhttps://www.scripps.edu/tainer/arvai/adxv.html')],
                               [sg.HorizontalSeparator(color = None,)],
                               [sg.Button('Okay', highlight_colors = (theme_color, theme_color)), sg.Button('Changelog', button_color = (theme_color, theme_color1), mouseover_colors = (theme_color1, theme_color), highlight_colors = (theme_color, theme_color)), sg.Button('License information', button_color = (theme_color, theme_color1), mouseover_colors = (theme_color1, theme_color), highlight_colors = (theme_color, theme_color)),sg.Text('Enable debug mode', size = (35, None), justification = 'right', text_color = '#D0D0D0', tooltip = 'Developer only!'), sg.Checkbox('', tooltip = 'Developer only!', default = debug, key = '-ERRTOGGLE-', text_color = '#D0D0D0', enable_events = True)]] 
            
        window_about = sg.Window('About', layout_about, no_titlebar=False, alpha_channel=1, grab_anywhere=False, finalize = True, location = (window.current_location()[0] + 200, window.current_location()[1] + 50 ))
        while True:
            event_about, values_about = window_about.read()
            if event_about == 'Changelog':
                layout_changes = [[sg.Multiline(size=(75,20), key='-CHANGELOG-', write_only = True, autoscroll = False, do_not_clear = True, text_color = theme_color, background_color = theme_color1)],
                                  [sg.Button('Okay', highlight_colors = (theme_color, theme_color))]]
                window_changes = sg.Window("What's new?", layout_changes, no_titlebar=False, alpha_channel=1, grab_anywhere=False, finalize = True, location = (window.current_location()[0] + 200, window.current_location()[1] + 50 ))
                
                if os.path.exists(changelog_path) == True:
                    f =  open(changelog_path, "r")
                    clog = f.read()
                    window_changes['-CHANGELOG-'].print(clog)
                    window_changes['-CHANGELOG-']. set_vscroll_position(0)
                    f.close()
                else:
                    window_changes['-CHANGELOG-'].print('')
                    window_changes['-CHANGELOG-'].print('autogui_changelog.txt not found!')
                    window_changes['-CHANGELOG-'].print('Sorry!')
                    window_changes['-CHANGELOG-'].print('')
                while True:
                    event_changes, values_changes = window_changes.read()    
                    if event_changes == sg.WIN_CLOSED or event_changes == 'Okay':
                        window_changes.close()
                        layout_changes = None
                        window_changes = None
                        gc.collect()
                        break
            
            if event_about == 'License information':
                layout_license = [[sg.Multiline(size=(75,20), key='-LICENSE-', write_only = True, autoscroll = False, do_not_clear = True, text_color = theme_color2, background_color = theme_color1)],
                                  [sg.Button('Okay', highlight_colors = (theme_color, theme_color))]]
                window_license = sg.Window("GPL-3.0-or-later", layout_license, no_titlebar=False, alpha_channel=1, grab_anywhere=False, finalize = True, location = (window.current_location()[0] + 200, window.current_location()[1] + 50 ))
                
                if os.path.exists(license_path) == True:
                    f =  open(license_path, "r")
                    lic = f.read()
                    window_license['-LICENSE-'].print(lic)
                    window_license['-LICENSE-']. set_vscroll_position(0)
                    f.close()
                else:
                    window_license['-LICENSE-'].print('')
                    window_license['-LICENSE-'].print('COPYING not found!')
                    window_license['-LICENSE-'].print('Sorry!')
                    window_license['-LICENSE-'].print('')
                while True:
                    event_license, values_license = window_license.read()    
                    if event_license == sg.WIN_CLOSED or event_license == 'Okay':
                        window_license.close()
                        layout_license = None
                        window_license = None
                        gc.collect()
                        break
            
            # Activate debugging
            if event_about == '-ERRTOGGLE-' and values_about['-ERRTOGGLE-'] == True:
                debug = True
            if event_about == '-ERRTOGGLE-' and values_about['-ERRTOGGLE-'] == False:
                debug = False
            
            if event_about == sg.WIN_CLOSED or event_about == 'Okay':
                window_about.close()
                gc.collect()
                break

    #Edit personal settings
    slider_disabled = True
    col1_true = True
    col2_true = col3_true = col4_true = col5_true = col6_true = col7_true = False
    if theme_color == color_option_1:
        col1_true = True 
        col2_true = col3_true = col4_true = col5_true = col6_true = col7_true = False
    elif theme_color == color_option_2:
        col2_true = True 
        col1_true = col3_true = col4_true = col5_true = col6_true = col7_true = False
    elif theme_color == color_option_3:
        col3_true = True
        col1_true = col2_true = col4_true = col5_true = col6_true = col7_true = False
    elif theme_color == color_option_4:
        col4_true = True
        col1_true = col2_true = col3_true = col5_true = col6_true = col7_true = False
    elif theme_color == color_option_5:
        col5_true = True 
        col1_true = col2_true = col3_true = col4_true = col6_true = col7_true = False
    elif theme_color == color_option_6:
        col6_true = True 
        col1_true = col2_true = col3_true = col4_true = col5_true = col7_true = False  
    else:
        col7_true = True 
        col1_true = col2_true = col3_true = col4_true = col5_true = col6_true = False
        slider_disabled = False                   

    if event == '-MENU-' and values['-MENU-'] == "Preferences":
        layout_personal_settings = [[sg.Text('Edit your personal settings', font = ("Arial 12"), text_color= theme_highlight_color ,size=(40,1))],
                            [sg.HorizontalSeparator()],
                            [sg.Frame(layout=[
                            [sg.Col([    
                            [sg.Checkbox("Use dark theme", key = '-DARKTHEME-', default= dark_theme, enable_events = True)],
                            [sg.HorizontalSeparator()],
                            [sg.Text('Highlight presets:',size=(27,1))],
                            [sg.Radio("1", 'HCOL', key = '-HCOL1-', size = (21, None), default = col1_true, enable_events = True, tooltip = color_option_1, background_color= color_option_1)],
                            [sg.Radio("2", 'HCOL', key = '-HCOL2-', size = (21, None), default = col2_true, enable_events = True, tooltip = color_option_2, background_color= color_option_2)],
                            [sg.Radio("3", 'HCOL', key = '-HCOL3-', size = (21, None), default = col3_true, enable_events = True, tooltip = color_option_3, background_color= color_option_3)],
                            [sg.Radio("4", 'HCOL', key = '-HCOL4-', size = (21, None), default = col3_true, enable_events = True, tooltip = color_option_4, background_color= color_option_4)],
                            [sg.Radio("5", 'HCOL', key = '-HCOL5-', size = (21, None), default = col5_true, enable_events = True, tooltip = color_option_5, background_color= color_option_5)],
                            [sg.Radio("6", 'HCOL', key = '-HCOL6-', size = (21, None), default = col6_true, enable_events = True, tooltip = color_option_6, background_color= color_option_6)],
                            [sg.HorizontalSeparator()],
                            [sg.Radio("Custom highlight:", 'HCOL', key = '-HCOL7-', size = (16, None), default = col7_true, enable_events = True, tooltip = 'Custom color')],
                            [sg.Text('R:'), sg.Slider(range = (0,255), default_value = (theme_color_rgb[0]), resolution = (5), key = '-RSLIDER-', orientation = 'horizontal', size = (16, 10), trough_color= "red", disabled = slider_disabled, enable_events = True)],
                            [sg.Text('G:'), sg.Slider(range = (0,255), default_value = (theme_color_rgb[1]), resolution = (5), key = '-GSLIDER-', orientation = 'horizontal', size = (16, 10), trough_color= "green", disabled = slider_disabled, enable_events = True)],
                            [sg.Text('B:'), sg.Slider(range = (0,255), default_value = (theme_color_rgb[2]), resolution = (5), key = '-BSLIDER-', orientation = 'horizontal', size = (16, 10), trough_color= "blue", disabled = slider_disabled, enable_events = True)],
                            [sg.Text('Ensure that background\nis suitable for both:')],
                            [sg.Text('dark text', key = '-DARKFIELD-', text_color = dark_theme_color, background_color= theme_color, justification = 'center', size = (11,1)), sg.Text('light text', key = '-LIGHTFIELD-', text_color = light_theme_color, background_color= theme_color, justification = 'center', size = (11,1))],
                            ],
                            size = (185, 500))]],
                            title = "Theme", title_color=theme_color, relief=sg.RELIEF_GROOVE),
                            sg.Frame(layout=[
                            [sg.Col([ 
                            [sg.Text('Default data storage path:',size=(26,1))],
                            [sg.InputText(default_text=inpath,key='-INROOT-',size=(46,1)),sg.FolderBrowse(initial_folder = inpath, button_text = 'Browse', tooltip = 'Default root folder for input files', target = '-INROOT-', size = (5,1))],
                            [sg.Text('Default output path:',size=(20,1))],
                            [sg.InputText(default_text=outpath,key='-OUTROOT-',size=(46,1)), sg.FolderBrowse(initial_folder = outpath, button_text = 'Browse', tooltip = 'Default root folder for output files', target = '-OUTROOT-', size = (5,1))],
                            [sg.Text('')],
                            [sg.Text('Subfolders to make:',size=(20,1))],
                            [sg.InputText(default_text=preplist,key='-PREPLIST-',size=(60,1))],
                            [sg.Checkbox("Make subfolders in CLASSIC mode", key = '-CLASSICFOLDER-', default= prepfolder_classic, enable_events = True)], 
                            [sg.Checkbox("Make subfolders in BATCH mode", key = '-BATCHFOLDER-', default= prepfolder_batch, enable_events = True)],
                            [sg.Text('')],
                            [sg.Checkbox('Enable "screen" for detached execution of BATCH mode', key = '-USESCREEN-', default= use_screen, enable_events = True, text_color = '#D0D0D0', tooltip= 'Do not deactivate this unless you have problems\nwith running AutoGUI Batch via "screen".')],
                            [sg.Text('')]],
                            size = (410, 500))]], 
                            title = "Settings", title_color=theme_color, relief=sg.RELIEF_GROOVE)],
                            [sg.HorizontalSeparator()],
                            [sg.Button('Save & Apply', key = '-SAVEAPPLY-',enable_events = True, tooltip = 'Save your preferences and apply theme.'), sg.Button('Restore Defaults', key = '-RESTOREDEFAULTS-',enable_events = True, tooltip = "Revert to AutoGUI's default settings."), sg.Button('Cancel')]]
        
        window_personal_settings = sg.Window('Make it yours', layout_personal_settings, no_titlebar=False, alpha_channel=1, grab_anywhere=False, finalize = True, location = (window.current_location()[0] + 200, window.current_location()[1] + 50 ))

        while True:
            event_personal_settings, values_personal_settings = window_personal_settings.read()
            if event_personal_settings == sg.WIN_CLOSED or event_personal_settings == 'Cancel':
                window_personal_settings.close()
                #layout_personal_settings = None
                #window_personal_settings = None
                gc.collect()
                break

            if event_personal_settings == '-HCOL1-':
                temp_color = color_option_1
                temp_color_rgb = hex_to_rgb(temp_color)
                window_personal_settings['-RSLIDER-'].update(value = temp_color_rgb[0], disabled = True)
                window_personal_settings['-GSLIDER-'].update(value = temp_color_rgb[1], disabled = True)  
                window_personal_settings['-BSLIDER-'].update(value = temp_color_rgb[2], disabled = True)
                window_personal_settings['-DARKFIELD-'].update(background_color = temp_color)
                window_personal_settings['-LIGHTFIELD-'].update(background_color = temp_color)
            if event_personal_settings == '-HCOL2-':
                temp_color = color_option_2
                temp_color_rgb = hex_to_rgb(temp_color)
                window_personal_settings['-RSLIDER-'].update(value = temp_color_rgb[0], disabled = True)
                window_personal_settings['-GSLIDER-'].update(value = temp_color_rgb[1], disabled = True)  
                window_personal_settings['-BSLIDER-'].update(value = temp_color_rgb[2], disabled = True)
                window_personal_settings['-DARKFIELD-'].update(background_color = temp_color)
                window_personal_settings['-LIGHTFIELD-'].update(background_color = temp_color)
            if event_personal_settings == '-HCOL3-':
                temp_color = color_option_3
                temp_color_rgb = hex_to_rgb(temp_color)
                window_personal_settings['-RSLIDER-'].update(value = temp_color_rgb[0], disabled = True)
                window_personal_settings['-GSLIDER-'].update(value = temp_color_rgb[1], disabled = True)  
                window_personal_settings['-BSLIDER-'].update(value = temp_color_rgb[2], disabled = True)
                window_personal_settings['-DARKFIELD-'].update(background_color = temp_color)
                window_personal_settings['-LIGHTFIELD-'].update(background_color = temp_color)  
            if event_personal_settings == '-HCOL4-':
                temp_color = color_option_4
                temp_color_rgb = hex_to_rgb(temp_color)
                window_personal_settings['-RSLIDER-'].update(value = temp_color_rgb[0], disabled = True)
                window_personal_settings['-GSLIDER-'].update(value = temp_color_rgb[1], disabled = True)  
                window_personal_settings['-BSLIDER-'].update(value = temp_color_rgb[2], disabled = True)
                window_personal_settings['-DARKFIELD-'].update(background_color = temp_color)
                window_personal_settings['-LIGHTFIELD-'].update(background_color = temp_color)
            if event_personal_settings == '-HCOL5-':
                temp_color = color_option_5
                temp_color_rgb = hex_to_rgb(temp_color)
                window_personal_settings['-RSLIDER-'].update(value = temp_color_rgb[0], disabled = True)
                window_personal_settings['-GSLIDER-'].update(value = temp_color_rgb[1], disabled = True)  
                window_personal_settings['-BSLIDER-'].update(value = temp_color_rgb[2], disabled = True)
                window_personal_settings['-DARKFIELD-'].update(background_color = temp_color)
                window_personal_settings['-LIGHTFIELD-'].update(background_color = temp_color)
            if event_personal_settings == '-HCOL6-':
                temp_color = color_option_6
                temp_color_rgb = hex_to_rgb(temp_color)
                window_personal_settings['-RSLIDER-'].update(value = temp_color_rgb[0], disabled = True)
                window_personal_settings['-GSLIDER-'].update(value = temp_color_rgb[1], disabled = True)  
                window_personal_settings['-BSLIDER-'].update(value = temp_color_rgb[2], disabled = True)
                window_personal_settings['-DARKFIELD-'].update(background_color = temp_color)
                window_personal_settings['-LIGHTFIELD-'].update(background_color = temp_color) 
            if event_personal_settings == '-HCOL7-':
                window_personal_settings['-RSLIDER-'].update(disabled = False)
                window_personal_settings['-GSLIDER-'].update(disabled = False)  
                window_personal_settings['-BSLIDER-'].update(disabled = False)

            if (event_personal_settings == '-RSLIDER-') or (event_personal_settings =='-GSLIDER-') or (event_personal_settings =='-BSLIDER-'):
                temp_color_rgb = [int(values_personal_settings['-RSLIDER-']),int(values_personal_settings['-GSLIDER-']), int(values_personal_settings['-BSLIDER-'])]
                temp_color = rgb_to_hex(temp_color_rgb)
                window_personal_settings['-DARKFIELD-'].update(background_color = temp_color)
                window_personal_settings['-LIGHTFIELD-'].update(background_color = temp_color)                                                  

            if event_personal_settings == '-SAVEAPPLY-':
                if values_personal_settings['-HCOL1-'] == True:
                    theme_highlight_color = color_option_1
                if values_personal_settings['-HCOL2-'] == True:
                    theme_highlight_color = color_option_2
                if values_personal_settings['-HCOL3-'] == True:
                    theme_highlight_color = color_option_3
                if values_personal_settings['-HCOL4-'] == True:
                    theme_highlight_color = color_option_4
                if values_personal_settings['-HCOL5-'] == True:
                    theme_highlight_color = color_option_5
                if values_personal_settings['-HCOL6-'] == True:
                    theme_highlight_color = color_option_6
                if values_personal_settings['-HCOL7-'] == True:
                    temp_color_rgb = [int(values_personal_settings['-RSLIDER-']),int(values_personal_settings['-GSLIDER-']), int(values_personal_settings['-BSLIDER-'])]
                    temp_color = rgb_to_hex(temp_color_rgb)
                    theme_highlight_color = temp_color   

                if values_personal_settings['-DARKTHEME-'] == True:
                    dark_theme = True
                    theme_color = theme_highlight_color                    # theme highlight color
                    theme_color1 =  dark_theme_color                       # theme background color
                    theme_color2 = 'white'                                 # theme text color
                    theme_color3 = '#2b2a32'                               # theme button and input text color
                if values_personal_settings['-DARKTHEME-'] == False:
                    dark_theme = False
                    theme_color = theme_highlight_color                   # theme highlight color
                    theme_color1 = light_theme_color                      # theme background color
                    theme_color2 = 'black'                                # theme text color
                    theme_color3 = 'white'                                # theme button and input text color

                inpath = values_personal_settings['-INROOT-']
                outpath = values_personal_settings['-OUTROOT-']
                preplist = values_personal_settings['-PREPLIST-']
                prepfolder_classic = values_personal_settings['-CLASSICFOLDER-']
                prepfolder_batch = values_personal_settings['-BATCHFOLDER-']
                use_screen = values_personal_settings['-USESCREEN-']

                sg.theme_background_color(theme_color1)
                sg.theme_text_color(theme_color2)
                sg.theme_text_element_background_color(theme_color1)
                sg.theme_element_background_color(theme_color1)
                sg.theme_button_color((theme_color3, theme_color)) 
                sg.theme_input_text_color(theme_color3)
                sg.theme_input_background_color(theme_color)
                sg.theme_slider_color(theme_color)
                sg.theme_progress_bar_color((theme_color, '#D0D0D0'))
            
                save_preferences(dark_theme, theme_highlight_color, prepfolder_classic, prepfolder_batch, preplist, inpath, outpath, use_screen)
                sg.popup('Preferences saved & applied.\nA restart of AutoGUI might be required for all settings to take effect.')
                window_personal_settings.close()
                #layout_personal_settings = None
                #window_personal_settings = None
                gc.collect()
                break
                
            if event_personal_settings == '-RESTOREDEFAULTS-':    
                if sg.popup_yes_no("Are you sure to revert your personal preferences to AutoGUI's default settings?") == 'Yes':
                    print('removing config.')

    # Search for previous results

    if event == '-MENU-' and values['-MENU-'] == "Load and export results":
        classicresults = True
        batchresults = True
        layout_findconfig = [[sg.Frame(layout=[
                                [sg.Col([
                                    [sg.Col([[sg.Text('Log-type(s) to search:',size=(27,1))],
                                    [sg.Checkbox("Classic", key = '-CLASSICRESULTS-', default= classicresults)], 
                                    [sg.Checkbox("Batch", key = '-BATCHRESULTS-', default= batchresults)],
                                    [sg.Text('')],
                                    [sg.Button('Search', highlight_colors = (theme_color, theme_color)), sg.Button('Defaults', tooltip = 'Reset to default values. (home-folder, max. 20 logs)', highlight_colors = (theme_color, theme_color))]
                                    ], size = (220, 160)),
                                    sg.Col([[sg.Text('Search path root:',size=(20,1))],
                                    [sg.InputText(default_text=find_path,key='-LOGROOT-',size=(33,1))],
                                    [sg.Text("Processing results to recover:"), sg.InputText(default_text=find_number,key='-LOGMAXNUM-',size=(6,2))],
                                    [sg.Text('')],
                                    [sg.Text('')] 
                                    ], size = (230, 160)),
                                    sg.Col ([[sg.Text('')],
                                    [sg.FolderBrowse(initial_folder = find_path, button_text = 'Browse', tooltip = 'Speed up things by narrowing down the file-tree for log-file search', target = '-LOGROOT-', size = (5,1))],
                                    [sg.Text('')],
                                    [sg.Text('')],
                                    [sg.Button('Close', highlight_colors = (theme_color, theme_color))]], size = (70, 160))]
                                ], size = (555, 165))]
                            ], title='Search for previous results',title_color=theme_color, relief=sg.RELIEF_GROOVE, vertical_alignment ="center")],
                            [sg.Frame(layout=[
                                [sg.Col([
                                    [sg.Table(table_values, ['Date','Type','Path'], num_rows=10,  def_col_width = 10, auto_size_columns = True, max_col_width = 50, enable_events= True, font = "Helvetica 9", justification = "left", key = '-RESULTSTABLE-' )],
                                    [sg.Button('Show selected result', key = '-SHOWRES-', disabled = True), sg.Button('Export results as CSV', key = '-EXPORTCSV-', disabled = True), sg.Button('Export results as HTML', key = '-EXPORTHTML-', disabled = True)]
                                ], size = (555, 250))]
                            ], title='Table of found results',title_color=theme_color, relief=sg.RELIEF_GROOVE, vertical_alignment ="center")],
                            [sg.StatusBar('\u2691  Ready.', key = '-STATUSBAR-', size = (60,1), font = ("Arial 8"))]
                            ]           
        window_findconfig = sg.Window('Find results', layout_findconfig, no_titlebar=False, alpha_channel=1, grab_anywhere=False, finalize = True, location = (window.current_location()[0] + 200, window.current_location()[1] + 50 ))
        #time.sleep(0.10)
        window_findconfig['-RESULTSTABLE-'].update(values = [])

        while True:
            event_findconfig, values_findconfig = window_findconfig.read()
            if event_findconfig == sg.WIN_CLOSED or event_findconfig == 'Close':
                window_findconfig.close()
                #layout_findconfig = None
                #window_findconfig = None
                gc.collect()
                break
            if event_findconfig == 'Defaults':
                defaultsearchpath = os.path.expanduser('~')
                window_findconfig['-LOGROOT-'].update(defaultsearchpath)
                window_findconfig['-LOGMAXNUM-'].update('20')
                find_number = values_findconfig['-LOGMAXNUM-']
            if event_findconfig == 'Search':
                find_path = values_findconfig['-LOGROOT-']
                find_number = values_findconfig['-LOGMAXNUM-']
                classicresults = values_findconfig['-CLASSICRESULTS-']
                batchresults = values_findconfig['-BATCHRESULTS-']
                if classicresults == False and batchresults == False:
                    classicresults = True
                    batchresults = True
                    window_findconfig['-CLASSICRESULTS-'].update(True)
                    window_findconfig['-BATCHRESULTS-'].update(True)
                stat = 'Searching for up to ' + find_number + ' results. Please wait...'
                print(stat)
                window_findconfig['-STATUSBAR-'].update(stat)
                window_findconfig.refresh()
                found_results = get_results(classicresults,batchresults,find_path,find_number)
                if len(found_results) > 0:
                    stat = 'Found ' + str(len(found_results)) + ' results from previous jobs.'
                    print(stat)
                    window_findconfig['-STATUSBAR-'].update(stat)
                    table_values = []
                    for found_result in found_results:
                        table_values.append(found_result)
                    window_findconfig['-RESULTSTABLE-'].update(values = table_values)
                    window_findconfig['-SHOWRES-'].update(disabled = False)
                    window_findconfig['-EXPORTCSV-'].update(disabled = False)
                    window_findconfig['-EXPORTHTML-'].update(disabled = False)
                    window_findconfig.refresh()
                    #print(table_values)
                else:
                    stat = 'Found no results from previous jobs.'
                    print(stat)
                    window_findconfig['-STATUSBAR-'].update(stat)
                    table_values = []
                    window_findconfig['-RESULTSTABLE-'].update(values = [])
                    window_findconfig['-SHOWRES-'].update(disabled = True)
                    window_findconfig['-EXPORTCSV-'].update(disabled = True)
                    window_findconfig['-EXPORTHTML-'].update(disabled = True)
                    window_findconfig.refresh()
            
            # select stuff in table
            if event_findconfig == '-RESULTSTABLE-':
                try:
                    rowlist = values_findconfig['-RESULTSTABLE-'][0]
                    table_path = (table_values[rowlist][2])
                    window_findconfig['-STATUSBAR-'].update(table_path)
                except:
                    #print("Something went wrong...")
                    print("")

            # open selected result in browser        
            if event_findconfig == '-SHOWRES-':
                browser_target = os.path.join(find_path, table_path.strip("./"))
                print(find_path)
                print(table_path)
                print(browser_target)
                browser_path = re.split("/", browser_target)
                if len(browser_path) > 7:
                    while len(browser_path) > 7:
                        del browser_path[0]
                    browser_path.insert(0,"...")    
                browser_t_short = "/".join(browser_path)    
                stat = 'Opening ' + browser_t_short + ' in webbrowser.'
                print(stat)  
                window_findconfig['-STATUSBAR-'].update(stat)
                open_browser(browser, browser_target)
                
            #export results table as CSV
            if event_findconfig == '-EXPORTCSV-':
                layout_export_csv = [[sg.Text('Export found results as CSV')],
                                [sg.InputText(default_text=find_path,key='-EXPORTPATH-',size=(36,1)), sg.FolderBrowse(initial_folder = find_path, button_text ='Browse', tooltip = 'Export table contents', target = '-EXPORTPATH-', size = (5,1))],
                [sg.Text('Filename:'), sg.InputText(default_text='AutoPROC_results',key='-EXPORTNAME-',size=(17,1)), sg.Button("Save"), sg.Button("Close")]] 

                window_export_csv = sg.Window('Export results', layout_export_csv, no_titlebar=False, alpha_channel=1, grab_anywhere=False, finalize = True, location = (window.current_location()[0] + 200, window.current_location()[1] + 50 ))

                while True:
                    event_export_csv, values_export_csv = window_export_csv.read()
                    if event_export_csv == sg.WIN_CLOSED or event_export_csv == 'Close':
                        window_export_csv.close()
                        layout_export_csv = None
                        window_export_csv = None
                        gc.collect()
                        break
                    exportextension = '.csv' 
                    exportname = re.sub("\s", "_", values_export_csv['-EXPORTNAME-'])
                    filetoexport = os.path.join(values_export_csv['-EXPORTPATH-'],(exportname + exportextension))
                    if os.path.exists(values_export_csv['-EXPORTPATH-']) == False:
                        sg.Popup("ERROR: Invalid path!")
                    elif os.path.exists(filetoexport) == True:
                        sg.Popup("ERROR: File already exists!")
                    else:    
                        export_results('.csv', values_export_csv['-EXPORTPATH-'],filetoexport, find_path, table_values, theme_color, theme_color1, theme_color2, include_commandline, exclude_failed, logtitle)
                        stat = "Wrote " + filetoexport
                        window_findconfig['-STATUSBAR-'].update(stat)
                        window_export_csv.close()
                        layout_export_csv = None
                        window_export_csv = None
                        gc.collect()
                        break

            #export results table as HTML
            if event_findconfig == '-EXPORTHTML-':
                layout_export_html = [[sg.Text('Export found results as HTML with'), sg.Combo(("relative links", "absolute links"), default_value = "relative links", key = "-SELECTEXPORT-", size = (16,1), readonly = True, change_submits = True, enable_events = True), sg.Checkbox('Enforce light color scheme', key = '-LIGHTSCHEME-', default = False, tooltip = "If using dark theme, make sure that report stays printer friendly")],
                [sg.Text('Title:', size = (10,1)), sg.InputText(default_text='Found AutoGUI Logs',key='-EXPORTTITLE-',size=(17,1)), sg.Checkbox('Include autoPROC command line', key = '-INCLAPCOM-', default = False), sg.Checkbox('Exclude failed runs', key = '-EXCLFAILED-', default = False)],
                [sg.Text('Filename:', size = (10,1)), sg.InputText(default_text='AutoPROC_results',key='-EXPORTNAME-',size=(17,1)),sg.InputText(default_text=find_path,key='-EXPORTPATH-',size=(42,1)), sg.FolderBrowse(initial_folder = find_path, button_text ='Browse', tooltip = 'Export results as HTML document', target = '-EXPORTPATH-', size = (5,1))],
                [sg.Button("Save"), sg.Button("Close")]] 

                window_export_html = sg.Window('Export results', layout_export_html, no_titlebar=False, alpha_channel=1, grab_anywhere=False, finalize = True, location = (window.current_location()[0] + 200, window.current_location()[1] + 50 ))

                while True:
                    event_export_html, values_export_html = window_export_html.read()
                    if event_export_html == sg.WIN_CLOSED or event_export_html == 'Close':
                        window_export_html.close()
                        layout_export_html = None
                        window_export_html = None
                        gc.collect()
                        break
                    if event_export_html =='Save':
                        exportextension = '.html'  
                        include_commandline = values_export_html['-INCLAPCOM-'] 
                        exclude_failed = values_export_html['-EXCLFAILED-'] 
                        logtitle = values_export_html['-EXPORTTITLE-'] 
                        exportname = re.sub("\s", "_", values_export_html['-EXPORTNAME-'])
                        filetoexport = os.path.join(values_export_html['-EXPORTPATH-'],(exportname + exportextension))
                        if os.path.exists(values_export_html['-EXPORTPATH-']) == False:
                            sg.Popup("ERROR: Invalid path!")
                        elif os.path.exists(filetoexport) == True:
                            sg.Popup("ERROR: File already exists!")
                        else:
                            if values_export_html['-LIGHTSCHEME-'] == True:
                                export_results(values_export_html['-SELECTEXPORT-'], values_export_html['-EXPORTPATH-'],filetoexport, find_path, table_values, theme_color, 'white', 'black', include_commandline, exclude_failed, logtitle)
                            else:       
                                export_results(values_export_html['-SELECTEXPORT-'], values_export_html['-EXPORTPATH-'],filetoexport, find_path, table_values, theme_color, theme_color1, theme_color2, include_commandline, exclude_failed, logtitle)
                            stat = "Wrote " + filetoexport
                            layout_open_html_list= [[sg.Text(stat)],
                                                    [sg.Text("Open now?")],
                                                    [sg.Button("Yes"), sg.Button("No")]]
                            window_open_html_list = sg.Window('Export results', layout_open_html_list, no_titlebar=False, alpha_channel=1, grab_anywhere=False, finalize = True, location = (window.current_location()[0] + 200, window.current_location()[1] + 50 ))
                            while True:
                                event_open_html_list, values_open_html_list= window_open_html_list.read()
                                if event_open_html_list == sg.WIN_CLOSED or event_open_html_list == 'No':
                                    window_open_html_list.close()
                                    layout_open_html_list = None
                                    window_open_html_list = None
                                    gc.collect()
                                    break
                                if event_open_html_list == 'Yes':
                                    stat = 'Opening ' + filetoexport + ' in webbrowser.'
                                    print(stat)  
                                    window_findconfig['-STATUSBAR-'].update(stat)
                                    browser_target = filetoexport
                                    open_browser(browser, browser_target)
                                    window_open_html_list.close()
                                    layout_open_html_list = None
                                    window_open_html_list = None
                                    gc.collect()
                                    break
                            window_findconfig['-STATUSBAR-'].update(stat)
                            window_export_html.close()
                            layout_export_html = None
                            window_export_html = None
                            gc.collect()
                            break            

    # kill screen session
    if event == '-MENU-' and values['-MENU-'] == "Kill previous batch job":
        screenargs = screen_info()
        foundscreens = []
        if len(screenargs) == 0 or len(screenargs[0]) != 3:
            foundscreens = []
            found_msg = 'No active sessions'
            found_disabled = True
            #print(screenargs[0])
        else:
            for screenarg in screenargs:
                #print(screenarg)
                screenfound = (screenarg[1]).strip()
                foundscreens.append(screenfound)
            found_msg = 'Select session'
            found_disabled = False 
        layout_kill = [[sg.Text("\u2620  Select session ID to kill:  \u2620", justification = "center")],
                       [sg.Combo((foundscreens),default_value= found_msg, key = '-KILLID-', size = (24, None), readonly = True, disabled = found_disabled, tooltip = 'Select "screen" session to nuke.')],
                       [sg.Button('Kill', tooltip = 'Fire', button_color = 'white on red', disabled = found_disabled), sg.Button('Cancel')]]
        window_kill= sg.Window('The Football \u2620', layout_kill, no_titlebar=False, alpha_channel=1, grab_anywhere=False, location = (window.current_location()[0] + 200, window.current_location()[1] + 50 ))
        while True:
            event_kill, values_kill = window_kill.read()
            if event_kill == sg.WIN_CLOSED or event_kill == 'Cancel':
                window_kill.close()
                layout_kill = None
                window_kill = None
                gc.collect()
                time.sleep(1)
                break
            if event_kill == 'Kill':
                window_kill.close()
                layout_kill = None
                window_kill = None
                gc.collect()                
                screenid = values_kill['-KILLID-']
                kill_command = 'screen -S ' + screenid + ' -X quit'
                os.system(kill_command)
                stat = 'Terminated screen: ' + screenid
                print(stat)
                time.sleep(1)
                break

    # Reattach screen session                    
    if event == '-MENU-' and values['-MENU-'] == "Connect to running batch job":
        screenargs = screen_info()
        foundscreens = []
        if len(screenargs) == 0 or len(screenargs[0]) != 3:
            foundscreens = []
            found_msg = 'No active sessions'
            found_disabled = True
            #print(screenargs[0])
        else:
            for screenarg in screenargs:
                #print(screenarg)
                screenfound = (screenarg[1]).strip()
                foundscreens.append(screenfound)
            found_msg = 'Select session'
            found_disabled = False              
        layout_screen = [[sg.Text("Select session ID to reconnect:", justification = "center")],
                         [sg.Combo((foundscreens),default_value= found_msg, key = '-SCREENID-', size = (24, None), readonly = True, disabled = found_disabled, tooltip = 'Select active screen session to reconnect.')], 
                         [sg.Button('Connect', tooltip = 'Reattach screen', disabled = found_disabled), sg.Button('Cancel')]]
        window_screen= sg.Window('Reattach screen', layout_screen, no_titlebar=False, alpha_channel=1, grab_anywhere=False, location = (window.current_location()[0] + 200, window.current_location()[1] + 50 ))
        while True:
            event_screen, values_screen = window_screen.read()
            if event_screen == sg.WIN_CLOSED or event_screen == 'Cancel':
                window_screen.close()
                layout_screen = None
                window_screen = None
                gc.collect()
                break
            if event_screen == 'Connect':
                screenid = values_screen['-SCREENID-'].strip()
                window_screen.close()               
                window.close()
                #layout_screen = None
                #window_screen = None
                #layout = None
                #window = None
                gc.collect()
                connect_command = 'screen -r -x ' + screenid
                if sys.platform == 'darwin':
                    screen_popup_msg = ('Reconnecting to a session is currently not supported on MacOS.\nPlease type the following line into your terminal:\n\n' + connect_command + '\n')
                    sg.popup(screen_popup_msg, title = "Attention Mac users!")
                    print('')
                    print('=======================================================')
                    print('')
                    print("Reconnecting to a session is currently not supported on MacOS.")
                    print('Please copy the following line into your terminal:')
                    print('')
                    print(connect_command)
                    print('')
                    print('=======================================================')
                    print('')
                else:    
                    os.system(connect_command)
                break                    

    # quit
    if event == sg.WIN_CLOSED or (event == '-MENU-' and values['-MENU-'] == 'Quit'):
        window.close()
        #layout = None
        #window = None
        gc.collect()
        break

    # Run classic AutoGUI in console
    if event == '-CLASSIC-':
        task = 'classic'
        window.close()
        #layout = None
        #window = None
        gc.collect()
        break

    # Run batch mode in screen
    if event == '-BATCH-':
        task = 'batch'
        window.close()
        #layout = None
        #window = None
        gc.collect()        
        break    

if task == 'classic':
    print('')
    print('Starting AutoGUI in CLASSIC mode for single dataset processing.')
    print('')
    if debug == True:
        classic_command = sys.executable + ' ' + classic_path + ' debug | tee autogui.debug.log 2>&1'
    else:
        classic_command = sys.executable + ' ' + classic_path
    os.system(classic_command)
    
elif task == 'batch':
    print('')
    print('Starting AutoGUI in BATCH mode for multi dataset processing.')
    print('')
    if use_screen != True:
        if debug == True:
            batch_command = sys.executable + ' ' + batch_path + ' ' + "dummy_screen_id" + ' debug | tee autogui.debug.log 2>&1'
        else:
            batch_command = sys.executable + ' ' + batch_path
    else:        
        n = 1
        m = n
        user = pwd.getpwuid(os.getuid()).pw_name
        while True:
            sessionid = "autogui_" + user + "_" + str(n)
            check_screen_command = 'screen -ls'
            screencheck = re.compile("[0-9]*\.?"+ sessionid)
            check_screen = subprocess.Popen(check_screen_command, stdout=subprocess.PIPE, universal_newlines=True, shell=True)
            output = (check_screen.stdout.readlines())
            m = n
            for line in output:
                line = line.strip()
                if screencheck.search(line) != None:
                    print(line)
                    n += 1
            if m == n:
                print('')
                print('screen session id is:', sessionid)
                print('')
                if sys.platform == 'darwin':
                    screen_popup_msg = ('MacOS currently prevents "screen" from starting attached.\nTo be able to see the terminal output from AutoGUI Batch,\nplease type the following line into your terminal:\n\nscreen -r -x ' + sessionid + '\n\nRunning AutoGUI Batch with its "screen" attached also\nprevents browser windows from closing automatically,\nif the browser was launched directly from the AutoGUI Batch process.')
                    sg.popup(screen_popup_msg, title = "Attention Mac users!")
                    print('=======================================================================')
                    print('')
                    print('***** ATTENTION *****')
                    print('')
                    print('MacOS currently prevents "screen" from starting attached.')
                    print('To be able to see the terminal output from AutoGUI Batch,')
                    print('please copy this into your terminal:')
                    print('')
                    print("screen -r -x ", sessionid)
                    print('')
                    print('Running AutoGUI Batch with its "screen" attached also')
                    print('prevents browser windows from closing automatically,')
                    print('if the browser was launched directly from the AutoGUI Batch process.')
                    print('')
                    print('=======================================================================')
                    print('')
                break  
        if sys.platform == 'darwin':                   
            if debug == True:
                batch_command = 'screen -dmS ' + sessionid + ' ' + sys.executable + ' ' + batch_path + ' ' + sessionid + ' debug | tee autogui.debug.log 2>&1'
            else:
                batch_command = 'screen -dmS ' + sessionid + ' ' + sys.executable + ' ' + batch_path + ' ' + sessionid
        else:
            if debug == True:
                batch_command = 'screen -S ' + sessionid + ' ' + sys.executable + ' ' + batch_path + ' ' + sessionid + ' debug | tee autogui.debug.log 2>&1'
            else:
                batch_command = 'screen -S ' + sessionid + ' ' + sys.executable + ' ' + batch_path + ' ' + sessionid        
    os.system(batch_command)  

else:
    print('')
    print('Closing.')
    print('')